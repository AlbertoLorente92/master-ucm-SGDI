\documentclass{article}
\usepackage{graphicx}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{caption} 

\captionsetup{skip=-30pt}

\pagenumbering{gobble}


\begin{document}

\title{Sistemas de Gestión de Datos y de la Información. Práctica Guiada 2.}
\author{Alberto Lorente y Hristo Ivanov}
\maketitle

  \begin{abstract}
     Respuesta de las preguntas de la sesión guiada 2.
  \end{abstract}

  \section{Preguntas.}
    \subsection{Pregunta 1. ¿Cuál es el plan ganador para la misma consulta ordenada por el nombre del usuario? db.users.find({'year':1980}).sort({'username':1})}
     Comando ejecutado: \texttt{db.users.find({'year':1980}).sort({'username':1}).explain(true)} \\
     Plan ganador: \texttt{SORT} \\
    \subsection{Pregunta 2. Considerando el índice year\_1, ¿cuáles son las etapas del plan ganador para la consulta de la pregunta anterior? db.users.find({'year':1980}).sort({'username':1})} 
     Comando ejecutado: db.users.find({'year':1980}).sort({'username':1}).explain(true) \\
     Plan ganador: SORT \\ 
     Etapas: SORT - KEEP\_MUTATIONS - SORT\_KEY\_GENERATOR - FETCH - IXSCAN \\
    \subsection{Considerando el mismo índice year\_1, ¿Cuáles son las etapas del plan ganador para lasiguiente consulta? db.users.find({'like':'deportes'}).sort({'year':1}) ¿Cuántos documentos y claves se examinan? ¿Qué rango de claves se recorre?} 
     Comando ejecutado: db.users.find({'like':'deportes'}).sort({'year':1}).explain(true) \\
     Plan ganador: FETCH \\
     Etapas: FETCH - IXSCAN \\
     Documentos examinados: 20000 \\
     Claves examinadas: 20000 \\
     Rango de claves recorrido: [0-20000] \\
    \subsection{Pregunta 4. Observa la evaluación de la consulta anterior tras crear el índice year\_1\_\_id\_1 y responde a las siguientes cuestiones: a) ¿Cuál es el plan ganador? ¿Qué índice usa? b) Cuántas claves y cuantos documentos consulta el plan ganador? c) ¿Cuáles son los planes rechazados? ¿Qué índices usan?} 
    Comando ejecutado: db.users.find({'year':1980},{'\_id':1}).explain(true) \\
    Plan ganador: PROJECTION \\
    Índice usado: year\_1\_\_id\_1 \\
    Documentos examinados: 0 \\
    Claves examinadas: 164 \\
    Plan rechazado: PROJECTION \\
    Índice usado: \_id \\
   \subsection{Pregunta 5. ¿Qué servidor se ha convertido en primario? ¿Por qué?} 
   
\end{document}

